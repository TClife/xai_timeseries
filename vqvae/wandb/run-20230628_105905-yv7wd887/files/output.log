dataset is hard_mitbih
X shape:torch.Size([400, 208]), y shape:torch.Size([400])
/home/smjo/xai_timeseries/vqvae/dataload.py:59: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:60: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_label = torch.tensor(torch.load(class0_label_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:62: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_label = torch.tensor(torch.load(class1_label_pth))
epoch[0] train_loss: 0.046704 	val_loss: 0.036094
epoch[1] train_loss: 0.046669 	val_loss: 0.036127
epoch[2] train_loss: 0.046510 	val_loss: 0.035712
epoch[3] train_loss: 0.046487 	val_loss: 0.035364
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
epoch[4] train_loss: 0.046301 	val_loss: 0.035472
epoch[5] train_loss: 0.046214 	val_loss: 0.035479
epoch[6] train_loss: 0.046218 	val_loss: 0.035296
epoch[7] train_loss: 0.045362 	val_loss: 0.032366
epoch[8] train_loss: 0.038554 	val_loss: 0.025578
epoch[9] train_loss: 0.026702 	val_loss: 0.018804
epoch[10] train_loss: 0.020658 	val_loss: 0.018099
epoch[11] train_loss: 0.020468 	val_loss: 0.017405
epoch[12] train_loss: 0.019812 	val_loss: 0.016872
epoch[13] train_loss: 0.019075 	val_loss: 0.016402
epoch[14] train_loss: 0.019029 	val_loss: 0.016047
epoch[15] train_loss: 0.019001 	val_loss: 0.015728
epoch[16] train_loss: 0.019388 	val_loss: 0.014435
epoch[17] train_loss: 0.017939 	val_loss: 0.014243
epoch[18] train_loss: 0.016852 	val_loss: 0.013551
epoch[19] train_loss: 0.016367 	val_loss: 0.013152
epoch[20] train_loss: 0.016015 	val_loss: 0.013730
epoch[21] train_loss: 0.016470 	val_loss: 0.013525
epoch[22] train_loss: 0.016206 	val_loss: 0.013065
epoch[23] train_loss: 0.015686 	val_loss: 0.012643
epoch[24] train_loss: 0.015494 	val_loss: 0.012652
epoch[25] train_loss: 0.015480 	val_loss: 0.012538
epoch[26] train_loss: 0.015261 	val_loss: 0.013634
epoch[27] train_loss: 0.015431 	val_loss: 0.012308
epoch[28] train_loss: 0.014949 	val_loss: 0.012802
epoch[29] train_loss: 0.014687 	val_loss: 0.012315
epoch[30] train_loss: 0.014426 	val_loss: 0.012125
epoch[31] train_loss: 0.014249 	val_loss: 0.012522
epoch[32] train_loss: 0.014079 	val_loss: 0.012157
epoch[33] train_loss: 0.013845 	val_loss: 0.012026
epoch[34] train_loss: 0.013677 	val_loss: 0.012012
epoch[35] train_loss: 0.013595 	val_loss: 0.011864
epoch[36] train_loss: 0.013564 	val_loss: 0.012102
epoch[37] train_loss: 0.013337 	val_loss: 0.011716
epoch[38] train_loss: 0.013273 	val_loss: 0.011581
epoch[39] train_loss: 0.013199 	val_loss: 0.011749
epoch[40] train_loss: 0.013441 	val_loss: 0.011624
epoch[41] train_loss: 0.013465 	val_loss: 0.011879
epoch[42] train_loss: 0.013813 	val_loss: 0.012114
epoch[43] train_loss: 0.013658 	val_loss: 0.012200
epoch[44] train_loss: 0.013526 	val_loss: 0.012123
epoch[45] train_loss: 0.013370 	val_loss: 0.011540
epoch[46] train_loss: 0.013159 	val_loss: 0.011809
epoch[47] train_loss: 0.013140 	val_loss: 0.011641
epoch[48] train_loss: 0.013173 	val_loss: 0.011717
epoch[49] train_loss: 0.013010 	val_loss: 0.012017
epoch[50] train_loss: 0.013490 	val_loss: 0.011991
epoch[51] train_loss: 0.013774 	val_loss: 0.011484
epoch[52] train_loss: 0.013097 	val_loss: 0.011420
epoch[53] train_loss: 0.012306 	val_loss: 0.010368
epoch[54] train_loss: 0.011451 	val_loss: 0.009608
epoch[55] train_loss: 0.011109 	val_loss: 0.009161
epoch[56] train_loss: 0.010858 	val_loss: 0.009014
epoch[57] train_loss: 0.010676 	val_loss: 0.008652
epoch[58] train_loss: 0.010655 	val_loss: 0.008840
epoch[59] train_loss: 0.010620 	val_loss: 0.008813
epoch[60] train_loss: 0.010488 	val_loss: 0.008679
epoch[61] train_loss: 0.010605 	val_loss: 0.008678
epoch[62] train_loss: 0.010480 	val_loss: 0.008884
epoch[63] train_loss: 0.010347 	val_loss: 0.008418
epoch[64] train_loss: 0.010314 	val_loss: 0.008451
epoch[65] train_loss: 0.010443 	val_loss: 0.008372
epoch[66] train_loss: 0.010259 	val_loss: 0.008409
epoch[67] train_loss: 0.010210 	val_loss: 0.008172
epoch[68] train_loss: 0.010165 	val_loss: 0.008179
epoch[69] train_loss: 0.010208 	val_loss: 0.008128
epoch[70] train_loss: 0.010006 	val_loss: 0.008253
epoch[71] train_loss: 0.010005 	val_loss: 0.008839
epoch[72] train_loss: 0.010330 	val_loss: 0.008302
epoch[73] train_loss: 0.010040 	val_loss: 0.008770
epoch[74] train_loss: 0.010306 	val_loss: 0.008391
epoch[75] train_loss: 0.009944 	val_loss: 0.007988
epoch[76] train_loss: 0.009699 	val_loss: 0.007943
epoch[77] train_loss: 0.009505 	val_loss: 0.007570
epoch[78] train_loss: 0.009445 	val_loss: 0.007686
epoch[79] train_loss: 0.009252 	val_loss: 0.007256
epoch[80] train_loss: 0.009194 	val_loss: 0.007422
epoch[81] train_loss: 0.009148 	val_loss: 0.007227
epoch[82] train_loss: 0.009287 	val_loss: 0.007271
epoch[83] train_loss: 0.009113 	val_loss: 0.007079
epoch[84] train_loss: 0.009045 	val_loss: 0.007405
epoch[85] train_loss: 0.009201 	val_loss: 0.007225
epoch[86] train_loss: 0.008993 	val_loss: 0.007112
epoch[87] train_loss: 0.009033 	val_loss: 0.007282
epoch[88] train_loss: 0.009337 	val_loss: 0.007489
epoch[89] train_loss: 0.009052 	val_loss: 0.006823
epoch[90] train_loss: 0.008991 	val_loss: 0.007064
epoch[91] train_loss: 0.009112 	val_loss: 0.007018
epoch[92] train_loss: 0.009111 	val_loss: 0.007431
epoch[93] train_loss: 0.008636 	val_loss: 0.007113
epoch[94] train_loss: 0.008603 	val_loss: 0.007256
epoch[95] train_loss: 0.008976 	val_loss: 0.007149
epoch[96] train_loss: 0.008750 	val_loss: 0.007058
epoch[97] train_loss: 0.008597 	val_loss: 0.007765
epoch[98] train_loss: 0.008538 	val_loss: 0.007101
epoch[99] train_loss: 0.008299 	val_loss: 0.006805
epoch[100] train_loss: 0.008270 	val_loss: 0.006929
epoch[101] train_loss: 0.008272 	val_loss: 0.006880
epoch[102] train_loss: 0.008190 	val_loss: 0.006962
epoch[103] train_loss: 0.008249 	val_loss: 0.006909
epoch[104] train_loss: 0.008354 	val_loss: 0.007388
epoch[105] train_loss: 0.008398 	val_loss: 0.007500
epoch[106] train_loss: 0.008274 	val_loss: 0.008122
epoch[107] train_loss: 0.008535 	val_loss: 0.007423
epoch[108] train_loss: 0.008216 	val_loss: 0.007340
epoch[109] train_loss: 0.008192 	val_loss: 0.007145
epoch[110] train_loss: 0.008064 	val_loss: 0.007073
epoch[111] train_loss: 0.008079 	val_loss: 0.006963
epoch[112] train_loss: 0.007994 	val_loss: 0.007083
epoch[113] train_loss: 0.008026 	val_loss: 0.007157
epoch[114] train_loss: 0.007979 	val_loss: 0.007088
epoch[115] train_loss: 0.008096 	val_loss: 0.007384
epoch[116] train_loss: 0.008131 	val_loss: 0.007143
epoch[117] train_loss: 0.008066 	val_loss: 0.007006
epoch[118] train_loss: 0.008050 	val_loss: 0.007029
epoch[119] train_loss: 0.008099 	val_loss: 0.007083
epoch[120] train_loss: 0.008212 	val_loss: 0.006818
epoch[121] train_loss: 0.008022 	val_loss: 0.006840
epoch[122] train_loss: 0.008040 	val_loss: 0.006716
epoch[123] train_loss: 0.008007 	val_loss: 0.007528
epoch[124] train_loss: 0.008059 	val_loss: 0.006662
epoch[125] train_loss: 0.007898 	val_loss: 0.006679
epoch[126] train_loss: 0.007867 	val_loss: 0.007080
epoch[127] train_loss: 0.007887 	val_loss: 0.006789
epoch[128] train_loss: 0.007764 	val_loss: 0.006775
epoch[129] train_loss: 0.007685 	val_loss: 0.006654
epoch[130] train_loss: 0.007748 	val_loss: 0.007031
epoch[131] train_loss: 0.007885 	val_loss: 0.006737
epoch[132] train_loss: 0.007825 	val_loss: 0.006791
epoch[133] train_loss: 0.007826 	val_loss: 0.007032
epoch[134] train_loss: 0.007875 	val_loss: 0.007067
epoch[135] train_loss: 0.008156 	val_loss: 0.006641
epoch[136] train_loss: 0.007945 	val_loss: 0.006873
epoch[137] train_loss: 0.007911 	val_loss: 0.006903
epoch[138] train_loss: 0.007990 	val_loss: 0.006519
epoch[139] train_loss: 0.007893 	val_loss: 0.007040
epoch[140] train_loss: 0.008079 	val_loss: 0.006862
epoch[141] train_loss: 0.007977 	val_loss: 0.006713
epoch[142] train_loss: 0.007904 	val_loss: 0.006861
epoch[143] train_loss: 0.007896 	val_loss: 0.007016
epoch[144] train_loss: 0.007732 	val_loss: 0.006519
epoch[145] train_loss: 0.007695 	val_loss: 0.006767
epoch[146] train_loss: 0.007728 	val_loss: 0.006561
epoch[147] train_loss: 0.007835 	val_loss: 0.006524
epoch[148] train_loss: 0.008064 	val_loss: 0.007200
epoch[149] train_loss: 0.008011 	val_loss: 0.007856
epoch[150] train_loss: 0.008477 	val_loss: 0.006836
epoch[151] train_loss: 0.008216 	val_loss: 0.006813
epoch[152] train_loss: 0.008017 	val_loss: 0.006728
epoch[153] train_loss: 0.007810 	val_loss: 0.006540
epoch[154] train_loss: 0.007635 	val_loss: 0.006676
epoch[155] train_loss: 0.007536 	val_loss: 0.006382
epoch[156] train_loss: 0.007778 	val_loss: 0.006576
epoch[157] train_loss: 0.007655 	val_loss: 0.006808
epoch[158] train_loss: 0.007660 	val_loss: 0.006517
epoch[159] train_loss: 0.007549 	val_loss: 0.006512
epoch[160] train_loss: 0.007539 	val_loss: 0.006699
epoch[161] train_loss: 0.007474 	val_loss: 0.006626
epoch[162] train_loss: 0.007473 	val_loss: 0.006636
epoch[163] train_loss: 0.007578 	val_loss: 0.006691
epoch[164] train_loss: 0.007688 	val_loss: 0.006446
epoch[165] train_loss: 0.007535 	val_loss: 0.006463
epoch[166] train_loss: 0.007453 	val_loss: 0.006475
epoch[167] train_loss: 0.007517 	val_loss: 0.006347
epoch[168] train_loss: 0.007650 	val_loss: 0.006568
epoch[169] train_loss: 0.007485 	val_loss: 0.006400
epoch[170] train_loss: 0.007665 	val_loss: 0.006660
epoch[171] train_loss: 0.007691 	val_loss: 0.006540
epoch[172] train_loss: 0.007585 	val_loss: 0.006767
epoch[173] train_loss: 0.007613 	val_loss: 0.006441
epoch[174] train_loss: 0.007606 	val_loss: 0.006426
epoch[175] train_loss: 0.007478 	val_loss: 0.006387
epoch[176] train_loss: 0.007507 	val_loss: 0.006360
epoch[177] train_loss: 0.007588 	val_loss: 0.006455
epoch[178] train_loss: 0.007516 	val_loss: 0.006209
epoch[179] train_loss: 0.007442 	val_loss: 0.006440
epoch[180] train_loss: 0.007533 	val_loss: 0.006612
epoch[181] train_loss: 0.007626 	val_loss: 0.006284
epoch[182] train_loss: 0.007537 	val_loss: 0.006401
epoch[183] train_loss: 0.007569 	val_loss: 0.006366
epoch[184] train_loss: 0.007508 	val_loss: 0.006441
epoch[185] train_loss: 0.007415 	val_loss: 0.006983
epoch[186] train_loss: 0.007870 	val_loss: 0.006608
epoch[187] train_loss: 0.007602 	val_loss: 0.006220
epoch[188] train_loss: 0.007505 	val_loss: 0.006259
epoch[189] train_loss: 0.007384 	val_loss: 0.006097
epoch[190] train_loss: 0.007358 	val_loss: 0.006157
epoch[191] train_loss: 0.007321 	val_loss: 0.006135
epoch[192] train_loss: 0.007302 	val_loss: 0.006259
epoch[193] train_loss: 0.006815 	val_loss: 0.006341
epoch[194] train_loss: 0.006703 	val_loss: 0.005961
epoch[195] train_loss: 0.006710 	val_loss: 0.005969
epoch[196] train_loss: 0.006519 	val_loss: 0.006000
epoch[197] train_loss: 0.006612 	val_loss: 0.005725
epoch[198] train_loss: 0.006592 	val_loss: 0.005808
epoch[199] train_loss: 0.006527 	val_loss: 0.005542
epoch[200] train_loss: 0.006462 	val_loss: 0.005735
epoch[201] train_loss: 0.006585 	val_loss: 0.006171
epoch[202] train_loss: 0.007130 	val_loss: 0.005955
epoch[203] train_loss: 0.006508 	val_loss: 0.005535
epoch[204] train_loss: 0.006597 	val_loss: 0.005848
epoch[205] train_loss: 0.006733 	val_loss: 0.005874
epoch[206] train_loss: 0.006792 	val_loss: 0.006183
epoch[207] train_loss: 0.007272 	val_loss: 0.006385
epoch[208] train_loss: 0.007091 	val_loss: 0.006386
epoch[209] train_loss: 0.006720 	val_loss: 0.005946
epoch[210] train_loss: 0.006816 	val_loss: 0.005800
epoch[211] train_loss: 0.006586 	val_loss: 0.005932
epoch[212] train_loss: 0.006501 	val_loss: 0.005604
epoch[213] train_loss: 0.006351 	val_loss: 0.005700
epoch[214] train_loss: 0.006316 	val_loss: 0.005787
epoch[215] train_loss: 0.006508 	val_loss: 0.005686
epoch[216] train_loss: 0.006582 	val_loss: 0.005531
epoch[217] train_loss: 0.006533 	val_loss: 0.006037
epoch[218] train_loss: 0.006537 	val_loss: 0.005610
epoch[219] train_loss: 0.006530 	val_loss: 0.005356
epoch[220] train_loss: 0.006346 	val_loss: 0.005534
epoch[221] train_loss: 0.006464 	val_loss: 0.005772
epoch[222] train_loss: 0.006276 	val_loss: 0.005509
epoch[223] train_loss: 0.006293 	val_loss: 0.005452
epoch[224] train_loss: 0.006265 	val_loss: 0.005451
epoch[225] train_loss: 0.006523 	val_loss: 0.005825
epoch[226] train_loss: 0.006368 	val_loss: 0.005455
epoch[227] train_loss: 0.006354 	val_loss: 0.005726
epoch[228] train_loss: 0.006471 	val_loss: 0.005410
epoch[229] train_loss: 0.006457 	val_loss: 0.005812
epoch[230] train_loss: 0.006355 	val_loss: 0.005413
epoch[231] train_loss: 0.006250 	val_loss: 0.005712
epoch[232] train_loss: 0.006335 	val_loss: 0.005422
epoch[233] train_loss: 0.006177 	val_loss: 0.005440
epoch[234] train_loss: 0.006239 	val_loss: 0.005626
epoch[235] train_loss: 0.006348 	val_loss: 0.005643
epoch[236] train_loss: 0.006371 	val_loss: 0.005957
epoch[237] train_loss: 0.006478 	val_loss: 0.005422
epoch[238] train_loss: 0.006267 	val_loss: 0.005540
epoch[239] train_loss: 0.006414 	val_loss: 0.005575
epoch[240] train_loss: 0.006160 	val_loss: 0.005420
epoch[241] train_loss: 0.006141 	val_loss: 0.005463
epoch[242] train_loss: 0.006075 	val_loss: 0.005428
epoch[243] train_loss: 0.006083 	val_loss: 0.005423
epoch[244] train_loss: 0.006134 	val_loss: 0.005443
epoch[245] train_loss: 0.006099 	val_loss: 0.005532
epoch[246] train_loss: 0.006345 	val_loss: 0.005767
epoch[247] train_loss: 0.006342 	val_loss: 0.005580
epoch[248] train_loss: 0.006155 	val_loss: 0.005476
epoch[249] train_loss: 0.006126 	val_loss: 0.005507
epoch[250] train_loss: 0.006163 	val_loss: 0.005661
epoch[251] train_loss: 0.006189 	val_loss: 0.005445
epoch[252] train_loss: 0.006160 	val_loss: 0.005504
epoch[253] train_loss: 0.006126 	val_loss: 0.005304
epoch[254] train_loss: 0.006101 	val_loss: 0.005343
epoch[255] train_loss: 0.006200 	val_loss: 0.005387
epoch[256] train_loss: 0.006102 	val_loss: 0.005498
epoch[257] train_loss: 0.006124 	val_loss: 0.005517
epoch[258] train_loss: 0.006106 	val_loss: 0.005484
epoch[259] train_loss: 0.006105 	val_loss: 0.005467
epoch[260] train_loss: 0.006142 	val_loss: 0.005545
epoch[261] train_loss: 0.006257 	val_loss: 0.005412
epoch[262] train_loss: 0.006201 	val_loss: 0.005635
epoch[263] train_loss: 0.006500 	val_loss: 0.005700
epoch[264] train_loss: 0.006528 	val_loss: 0.005818
epoch[265] train_loss: 0.006427 	val_loss: 0.005815
epoch[266] train_loss: 0.006681 	val_loss: 0.005676
epoch[267] train_loss: 0.006449 	val_loss: 0.005702
epoch[268] train_loss: 0.006410 	val_loss: 0.005624
epoch[269] train_loss: 0.006375 	val_loss: 0.005395
epoch[270] train_loss: 0.006210 	val_loss: 0.005661
epoch[271] train_loss: 0.006275 	val_loss: 0.005784
epoch[272] train_loss: 0.006216 	val_loss: 0.005686
epoch[273] train_loss: 0.006251 	val_loss: 0.005432
epoch[274] train_loss: 0.006245 	val_loss: 0.005706
epoch[275] train_loss: 0.006304 	val_loss: 0.005674
epoch[276] train_loss: 0.006260 	val_loss: 0.005661
epoch[277] train_loss: 0.006530 	val_loss: 0.005806
epoch[278] train_loss: 0.006415 	val_loss: 0.005598
epoch[279] train_loss: 0.006297 	val_loss: 0.005631
epoch[280] train_loss: 0.006236 	val_loss: 0.005567
epoch[281] train_loss: 0.006356 	val_loss: 0.005614
epoch[282] train_loss: 0.006494 	val_loss: 0.005427
epoch[283] train_loss: 0.006166 	val_loss: 0.005433
epoch[284] train_loss: 0.006154 	val_loss: 0.005448
epoch[285] train_loss: 0.006092 	val_loss: 0.005236
epoch[286] train_loss: 0.006102 	val_loss: 0.005264
epoch[287] train_loss: 0.006120 	val_loss: 0.005308
epoch[288] train_loss: 0.006132 	val_loss: 0.005377
epoch[289] train_loss: 0.006326 	val_loss: 0.005515
epoch[290] train_loss: 0.006293 	val_loss: 0.005275
epoch[291] train_loss: 0.006182 	val_loss: 0.005453
epoch[292] train_loss: 0.006433 	val_loss: 0.005407
epoch[293] train_loss: 0.006278 	val_loss: 0.005535
epoch[294] train_loss: 0.006288 	val_loss: 0.005339
epoch[295] train_loss: 0.006220 	val_loss: 0.005493
epoch[296] train_loss: 0.006398 	val_loss: 0.005945
epoch[297] train_loss: 0.006721 	val_loss: 0.005576
epoch[298] train_loss: 0.006595 	val_loss: 0.005833
epoch[299] train_loss: 0.006668 	val_loss: 0.005671
epoch[300] train_loss: 0.008186 	val_loss: 0.007814
try to save in testdir
285 save ... ./saved_models/hard_mitbih/1/
train: 0.0061	
val: 0.0052	
save done!