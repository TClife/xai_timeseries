dataset is hard_mitbih
X shape:torch.Size([400, 208]), y shape:torch.Size([400])
/home/smjo/xai_timeseries/vqvae/dataload.py:59: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:60: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_label = torch.tensor(torch.load(class0_label_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:62: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_label = torch.tensor(torch.load(class1_label_pth))
epoch[0] train_loss: 0.052418 	val_loss: 0.036505
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
epoch[1] train_loss: 0.048106 	val_loss: 0.035548
epoch[2] train_loss: 0.046670 	val_loss: 0.036924
epoch[3] train_loss: 0.046251 	val_loss: 0.035920
epoch[4] train_loss: 0.043985 	val_loss: 0.032870
epoch[5] train_loss: 0.035079 	val_loss: 0.023175
epoch[6] train_loss: 0.021648 	val_loss: 0.017452
epoch[7] train_loss: 0.018566 	val_loss: 0.017790
epoch[8] train_loss: 0.017276 	val_loss: 0.014206
epoch[9] train_loss: 0.014423 	val_loss: 0.012413
epoch[10] train_loss: 0.013339 	val_loss: 0.012147
epoch[11] train_loss: 0.012855 	val_loss: 0.011392
epoch[12] train_loss: 0.011907 	val_loss: 0.010399
epoch[13] train_loss: 0.011017 	val_loss: 0.009590
epoch[14] train_loss: 0.009853 	val_loss: 0.008295
epoch[15] train_loss: 0.008456 	val_loss: 0.007224
epoch[16] train_loss: 0.007827 	val_loss: 0.007029
epoch[17] train_loss: 0.007632 	val_loss: 0.006659
epoch[18] train_loss: 0.007271 	val_loss: 0.006318
epoch[19] train_loss: 0.007057 	val_loss: 0.006169
epoch[20] train_loss: 0.006851 	val_loss: 0.005969
epoch[21] train_loss: 0.006737 	val_loss: 0.005779
epoch[22] train_loss: 0.006591 	val_loss: 0.005670
epoch[23] train_loss: 0.006419 	val_loss: 0.005548
epoch[24] train_loss: 0.006323 	val_loss: 0.005442
epoch[25] train_loss: 0.006199 	val_loss: 0.005417
epoch[26] train_loss: 0.006102 	val_loss: 0.005306
epoch[27] train_loss: 0.006027 	val_loss: 0.005217
epoch[28] train_loss: 0.005926 	val_loss: 0.005160
epoch[29] train_loss: 0.005808 	val_loss: 0.005037
epoch[30] train_loss: 0.005650 	val_loss: 0.004871
epoch[31] train_loss: 0.005421 	val_loss: 0.004660
epoch[32] train_loss: 0.005084 	val_loss: 0.004393
epoch[33] train_loss: 0.004642 	val_loss: 0.003878
epoch[34] train_loss: 0.004034 	val_loss: 0.003432
epoch[35] train_loss: 0.003656 	val_loss: 0.003211
epoch[36] train_loss: 0.003432 	val_loss: 0.002920
epoch[37] train_loss: 0.003150 	val_loss: 0.002707
epoch[38] train_loss: 0.002953 	val_loss: 0.002484
epoch[39] train_loss: 0.002720 	val_loss: 0.002284
epoch[40] train_loss: 0.002522 	val_loss: 0.002155
epoch[41] train_loss: 0.002388 	val_loss: 0.002032
epoch[42] train_loss: 0.002331 	val_loss: 0.001949
epoch[43] train_loss: 0.002244 	val_loss: 0.001897
epoch[44] train_loss: 0.002137 	val_loss: 0.001808
epoch[45] train_loss: 0.002089 	val_loss: 0.001708
epoch[46] train_loss: 0.002035 	val_loss: 0.001708
epoch[47] train_loss: 0.001954 	val_loss: 0.001605
epoch[48] train_loss: 0.001899 	val_loss: 0.001523
epoch[49] train_loss: 0.001835 	val_loss: 0.001488
epoch[50] train_loss: 0.001828 	val_loss: 0.001481
epoch[51] train_loss: 0.001797 	val_loss: 0.001402
epoch[52] train_loss: 0.001759 	val_loss: 0.001337
epoch[53] train_loss: 0.001718 	val_loss: 0.001371
epoch[54] train_loss: 0.001725 	val_loss: 0.001327
epoch[55] train_loss: 0.001656 	val_loss: 0.001325
epoch[56] train_loss: 0.001603 	val_loss: 0.001273
epoch[57] train_loss: 0.001563 	val_loss: 0.001253
epoch[58] train_loss: 0.001529 	val_loss: 0.001224
epoch[59] train_loss: 0.001516 	val_loss: 0.001239
epoch[60] train_loss: 0.001490 	val_loss: 0.001204
epoch[61] train_loss: 0.001473 	val_loss: 0.001187
epoch[62] train_loss: 0.001458 	val_loss: 0.001186
epoch[63] train_loss: 0.001425 	val_loss: 0.001223
epoch[64] train_loss: 0.001450 	val_loss: 0.001254
epoch[65] train_loss: 0.001445 	val_loss: 0.001224
epoch[66] train_loss: 0.001439 	val_loss: 0.001243
epoch[67] train_loss: 0.001432 	val_loss: 0.001134
epoch[68] train_loss: 0.001391 	val_loss: 0.001211
epoch[69] train_loss: 0.001376 	val_loss: 0.001122
epoch[70] train_loss: 0.001332 	val_loss: 0.001126
epoch[71] train_loss: 0.001318 	val_loss: 0.001075
epoch[72] train_loss: 0.001302 	val_loss: 0.001086
epoch[73] train_loss: 0.001263 	val_loss: 0.001075
epoch[74] train_loss: 0.001246 	val_loss: 0.001076
epoch[75] train_loss: 0.001251 	val_loss: 0.001067
epoch[76] train_loss: 0.001232 	val_loss: 0.001025
epoch[77] train_loss: 0.001212 	val_loss: 0.001034
epoch[78] train_loss: 0.001185 	val_loss: 0.001020
epoch[79] train_loss: 0.001176 	val_loss: 0.001002
epoch[80] train_loss: 0.001167 	val_loss: 0.001004
epoch[81] train_loss: 0.001178 	val_loss: 0.001018
epoch[82] train_loss: 0.001170 	val_loss: 0.001034
epoch[83] train_loss: 0.001163 	val_loss: 0.001085
epoch[84] train_loss: 0.001192 	val_loss: 0.001011
epoch[85] train_loss: 0.001156 	val_loss: 0.001008
epoch[86] train_loss: 0.001142 	val_loss: 0.000978
epoch[87] train_loss: 0.001111 	val_loss: 0.001016
epoch[88] train_loss: 0.001097 	val_loss: 0.000957
epoch[89] train_loss: 0.001072 	val_loss: 0.000974
epoch[90] train_loss: 0.001068 	val_loss: 0.000930
epoch[91] train_loss: 0.001045 	val_loss: 0.000949
epoch[92] train_loss: 0.001047 	val_loss: 0.000952
epoch[93] train_loss: 0.001035 	val_loss: 0.000974
epoch[94] train_loss: 0.001019 	val_loss: 0.000923
epoch[95] train_loss: 0.001005 	val_loss: 0.000924
epoch[96] train_loss: 0.000999 	val_loss: 0.000917
epoch[97] train_loss: 0.000993 	val_loss: 0.000906
epoch[98] train_loss: 0.000983 	val_loss: 0.000923
epoch[99] train_loss: 0.000976 	val_loss: 0.000897
epoch[100] train_loss: 0.000960 	val_loss: 0.000925
epoch[101] train_loss: 0.000962 	val_loss: 0.000884
epoch[102] train_loss: 0.000943 	val_loss: 0.000922
epoch[103] train_loss: 0.000941 	val_loss: 0.000873
epoch[104] train_loss: 0.000914 	val_loss: 0.000872
epoch[105] train_loss: 0.000912 	val_loss: 0.000895
epoch[106] train_loss: 0.000915 	val_loss: 0.000879
epoch[107] train_loss: 0.000899 	val_loss: 0.000878
epoch[108] train_loss: 0.000889 	val_loss: 0.000865
epoch[109] train_loss: 0.000882 	val_loss: 0.000827
epoch[110] train_loss: 0.000874 	val_loss: 0.000851
epoch[111] train_loss: 0.000876 	val_loss: 0.000848
epoch[112] train_loss: 0.000853 	val_loss: 0.000835
epoch[113] train_loss: 0.000873 	val_loss: 0.000834
epoch[114] train_loss: 0.000845 	val_loss: 0.000810
epoch[115] train_loss: 0.000832 	val_loss: 0.000808
epoch[116] train_loss: 0.000810 	val_loss: 0.000805
epoch[117] train_loss: 0.000798 	val_loss: 0.000784
epoch[118] train_loss: 0.000795 	val_loss: 0.000778
epoch[119] train_loss: 0.000788 	val_loss: 0.000799
epoch[120] train_loss: 0.000779 	val_loss: 0.000784
epoch[121] train_loss: 0.000807 	val_loss: 0.000790
epoch[122] train_loss: 0.000878 	val_loss: 0.000800
epoch[123] train_loss: 0.000835 	val_loss: 0.000825
epoch[124] train_loss: 0.000819 	val_loss: 0.000796
epoch[125] train_loss: 0.000787 	val_loss: 0.000754
epoch[126] train_loss: 0.000775 	val_loss: 0.000768
epoch[127] train_loss: 0.000764 	val_loss: 0.000757
epoch[128] train_loss: 0.000755 	val_loss: 0.000727
epoch[129] train_loss: 0.000742 	val_loss: 0.000693
epoch[130] train_loss: 0.000722 	val_loss: 0.000708
epoch[131] train_loss: 0.000698 	val_loss: 0.000691
epoch[132] train_loss: 0.000691 	val_loss: 0.000677
epoch[133] train_loss: 0.000682 	val_loss: 0.000688
epoch[134] train_loss: 0.000689 	val_loss: 0.000689
epoch[135] train_loss: 0.000715 	val_loss: 0.000734
epoch[136] train_loss: 0.000722 	val_loss: 0.000729
epoch[137] train_loss: 0.000712 	val_loss: 0.000732
epoch[138] train_loss: 0.000700 	val_loss: 0.000669
epoch[139] train_loss: 0.000673 	val_loss: 0.000664
epoch[140] train_loss: 0.000665 	val_loss: 0.000662
epoch[141] train_loss: 0.000651 	val_loss: 0.000651
epoch[142] train_loss: 0.000630 	val_loss: 0.000644
epoch[143] train_loss: 0.000622 	val_loss: 0.000630
epoch[144] train_loss: 0.000622 	val_loss: 0.000629
epoch[145] train_loss: 0.000608 	val_loss: 0.000606
epoch[146] train_loss: 0.000598 	val_loss: 0.000591
epoch[147] train_loss: 0.000592 	val_loss: 0.000596
epoch[148] train_loss: 0.000584 	val_loss: 0.000596
epoch[149] train_loss: 0.000578 	val_loss: 0.000585
epoch[150] train_loss: 0.000578 	val_loss: 0.000586
epoch[151] train_loss: 0.000568 	val_loss: 0.000581
epoch[152] train_loss: 0.000568 	val_loss: 0.000571
epoch[153] train_loss: 0.000573 	val_loss: 0.000558
epoch[154] train_loss: 0.000559 	val_loss: 0.000580
epoch[155] train_loss: 0.000559 	val_loss: 0.000571
epoch[156] train_loss: 0.000551 	val_loss: 0.000588
epoch[157] train_loss: 0.000553 	val_loss: 0.000575
epoch[158] train_loss: 0.000562 	val_loss: 0.000583
epoch[159] train_loss: 0.000571 	val_loss: 0.000580
epoch[160] train_loss: 0.000573 	val_loss: 0.000559
epoch[161] train_loss: 0.000545 	val_loss: 0.000524
epoch[162] train_loss: 0.000543 	val_loss: 0.000554
epoch[163] train_loss: 0.000538 	val_loss: 0.000565
epoch[164] train_loss: 0.000534 	val_loss: 0.000523
epoch[165] train_loss: 0.000520 	val_loss: 0.000506
epoch[166] train_loss: 0.000534 	val_loss: 0.000513
epoch[167] train_loss: 0.000526 	val_loss: 0.000540
epoch[168] train_loss: 0.000608 	val_loss: 0.000660
epoch[169] train_loss: 0.000592 	val_loss: 0.000666
epoch[170] train_loss: 0.000596 	val_loss: 0.000582
epoch[171] train_loss: 0.000535 	val_loss: 0.000517
epoch[172] train_loss: 0.000503 	val_loss: 0.000482
epoch[173] train_loss: 0.000489 	val_loss: 0.000463
epoch[174] train_loss: 0.000468 	val_loss: 0.000476
epoch[175] train_loss: 0.000458 	val_loss: 0.000449
epoch[176] train_loss: 0.000447 	val_loss: 0.000461
epoch[177] train_loss: 0.000452 	val_loss: 0.000468
epoch[178] train_loss: 0.000443 	val_loss: 0.000444
epoch[179] train_loss: 0.000435 	val_loss: 0.000443
epoch[180] train_loss: 0.000440 	val_loss: 0.000455
epoch[181] train_loss: 0.000439 	val_loss: 0.000462
epoch[182] train_loss: 0.000438 	val_loss: 0.000442
epoch[183] train_loss: 0.000433 	val_loss: 0.000429
epoch[184] train_loss: 0.000429 	val_loss: 0.000436
epoch[185] train_loss: 0.000421 	val_loss: 0.000427
epoch[186] train_loss: 0.000417 	val_loss: 0.000419
epoch[187] train_loss: 0.000411 	val_loss: 0.000436
epoch[188] train_loss: 0.000419 	val_loss: 0.000435
epoch[189] train_loss: 0.000423 	val_loss: 0.000429
epoch[190] train_loss: 0.000416 	val_loss: 0.000442
epoch[191] train_loss: 0.000429 	val_loss: 0.000460
epoch[192] train_loss: 0.000446 	val_loss: 0.000440
epoch[193] train_loss: 0.000426 	val_loss: 0.000439
epoch[194] train_loss: 0.000423 	val_loss: 0.000445
epoch[195] train_loss: 0.000410 	val_loss: 0.000444
epoch[196] train_loss: 0.000414 	val_loss: 0.000414
epoch[197] train_loss: 0.000396 	val_loss: 0.000419
epoch[198] train_loss: 0.000399 	val_loss: 0.000411
epoch[199] train_loss: 0.000387 	val_loss: 0.000406
epoch[200] train_loss: 0.000382 	val_loss: 0.000417
epoch[201] train_loss: 0.000386 	val_loss: 0.000403
epoch[202] train_loss: 0.000378 	val_loss: 0.000414
epoch[203] train_loss: 0.000386 	val_loss: 0.000391
epoch[204] train_loss: 0.000381 	val_loss: 0.000413
epoch[205] train_loss: 0.000384 	val_loss: 0.000450
epoch[206] train_loss: 0.000394 	val_loss: 0.000422
epoch[207] train_loss: 0.000384 	val_loss: 0.000407
epoch[208] train_loss: 0.000376 	val_loss: 0.000396
epoch[209] train_loss: 0.000375 	val_loss: 0.000403
epoch[210] train_loss: 0.000373 	val_loss: 0.000391
epoch[211] train_loss: 0.000362 	val_loss: 0.000385
epoch[212] train_loss: 0.000350 	val_loss: 0.000391
epoch[213] train_loss: 0.000350 	val_loss: 0.000380
epoch[214] train_loss: 0.000346 	val_loss: 0.000388
epoch[215] train_loss: 0.000347 	val_loss: 0.000374
epoch[216] train_loss: 0.000349 	val_loss: 0.000395
epoch[217] train_loss: 0.000358 	val_loss: 0.000381
epoch[218] train_loss: 0.000344 	val_loss: 0.000374
epoch[219] train_loss: 0.000347 	val_loss: 0.000376
epoch[220] train_loss: 0.000347 	val_loss: 0.000370
epoch[221] train_loss: 0.000341 	val_loss: 0.000379
epoch[222] train_loss: 0.000356 	val_loss: 0.000400
epoch[223] train_loss: 0.000359 	val_loss: 0.000370
epoch[224] train_loss: 0.000340 	val_loss: 0.000379
epoch[225] train_loss: 0.000346 	val_loss: 0.000387
epoch[226] train_loss: 0.000350 	val_loss: 0.000384
epoch[227] train_loss: 0.000343 	val_loss: 0.000377
epoch[228] train_loss: 0.000333 	val_loss: 0.000375
epoch[229] train_loss: 0.000326 	val_loss: 0.000370
epoch[230] train_loss: 0.000328 	val_loss: 0.000367
epoch[231] train_loss: 0.000324 	val_loss: 0.000372
epoch[232] train_loss: 0.000329 	val_loss: 0.000373
epoch[233] train_loss: 0.000329 	val_loss: 0.000359
epoch[234] train_loss: 0.000333 	val_loss: 0.000376
epoch[235] train_loss: 0.000341 	val_loss: 0.000369
epoch[236] train_loss: 0.000331 	val_loss: 0.000376
epoch[237] train_loss: 0.000329 	val_loss: 0.000363
epoch[238] train_loss: 0.000333 	val_loss: 0.000377
epoch[239] train_loss: 0.000342 	val_loss: 0.000372
epoch[240] train_loss: 0.000334 	val_loss: 0.000383
epoch[241] train_loss: 0.000328 	val_loss: 0.000352
epoch[242] train_loss: 0.000319 	val_loss: 0.000359
epoch[243] train_loss: 0.000307 	val_loss: 0.000357
epoch[244] train_loss: 0.000310 	val_loss: 0.000346
epoch[245] train_loss: 0.000306 	val_loss: 0.000351
epoch[246] train_loss: 0.000309 	val_loss: 0.000359
epoch[247] train_loss: 0.000318 	val_loss: 0.000369
epoch[248] train_loss: 0.000333 	val_loss: 0.000346
epoch[249] train_loss: 0.000326 	val_loss: 0.000364
epoch[250] train_loss: 0.000316 	val_loss: 0.000357
epoch[251] train_loss: 0.000313 	val_loss: 0.000362
epoch[252] train_loss: 0.000314 	val_loss: 0.000357
epoch[253] train_loss: 0.000313 	val_loss: 0.000362
epoch[254] train_loss: 0.000318 	val_loss: 0.000359
epoch[255] train_loss: 0.000310 	val_loss: 0.000382
epoch[256] train_loss: 0.000315 	val_loss: 0.000353
epoch[257] train_loss: 0.000317 	val_loss: 0.000355
epoch[258] train_loss: 0.000306 	val_loss: 0.000341
epoch[259] train_loss: 0.000301 	val_loss: 0.000339
epoch[260] train_loss: 0.000296 	val_loss: 0.000349
epoch[261] train_loss: 0.000296 	val_loss: 0.000353
epoch[262] train_loss: 0.000301 	val_loss: 0.000347
epoch[263] train_loss: 0.000305 	val_loss: 0.000346
epoch[264] train_loss: 0.000310 	val_loss: 0.000355
epoch[265] train_loss: 0.000308 	val_loss: 0.000340
epoch[266] train_loss: 0.000310 	val_loss: 0.000356
epoch[267] train_loss: 0.000304 	val_loss: 0.000362
epoch[268] train_loss: 0.000300 	val_loss: 0.000357
epoch[269] train_loss: 0.000297 	val_loss: 0.000342
epoch[270] train_loss: 0.000292 	val_loss: 0.000336
epoch[271] train_loss: 0.000288 	val_loss: 0.000332
epoch[272] train_loss: 0.000289 	val_loss: 0.000343
epoch[273] train_loss: 0.000298 	val_loss: 0.000366
epoch[274] train_loss: 0.000302 	val_loss: 0.000331
epoch[275] train_loss: 0.000291 	val_loss: 0.000341
epoch[276] train_loss: 0.000287 	val_loss: 0.000339
epoch[277] train_loss: 0.000295 	val_loss: 0.000352
epoch[278] train_loss: 0.000291 	val_loss: 0.000346
epoch[279] train_loss: 0.000293 	val_loss: 0.000352
epoch[280] train_loss: 0.000285 	val_loss: 0.000319
epoch[281] train_loss: 0.000289 	val_loss: 0.000352
epoch[282] train_loss: 0.000302 	val_loss: 0.000363
epoch[283] train_loss: 0.000312 	val_loss: 0.000331
epoch[284] train_loss: 0.000312 	val_loss: 0.000373
epoch[285] train_loss: 0.000317 	val_loss: 0.000337
epoch[286] train_loss: 0.000323 	val_loss: 0.000388
epoch[287] train_loss: 0.000315 	val_loss: 0.000396
epoch[288] train_loss: 0.000316 	val_loss: 0.000346
epoch[289] train_loss: 0.000312 	val_loss: 0.000356
epoch[290] train_loss: 0.000291 	val_loss: 0.000343
epoch[291] train_loss: 0.000277 	val_loss: 0.000329
epoch[292] train_loss: 0.000274 	val_loss: 0.000317
epoch[293] train_loss: 0.000274 	val_loss: 0.000328
epoch[294] train_loss: 0.000276 	val_loss: 0.000329
epoch[295] train_loss: 0.000267 	val_loss: 0.000340
epoch[296] train_loss: 0.000270 	val_loss: 0.000344
epoch[297] train_loss: 0.000275 	val_loss: 0.000328
epoch[298] train_loss: 0.000272 	val_loss: 0.000339
epoch[299] train_loss: 0.000281 	val_loss: 0.000364
epoch[300] train_loss: 0.000285 	val_loss: 0.000332
try to save in testdir
292 save ... ./saved_models/hard_mitbih/8/
train: 0.0003	
val: 0.0003	
save done!