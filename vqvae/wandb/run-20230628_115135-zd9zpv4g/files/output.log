dataset is hard_mitbih
X shape:torch.Size([400, 208]), y shape:torch.Size([400])
/home/smjo/xai_timeseries/vqvae/dataload.py:59: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:60: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_label = torch.tensor(torch.load(class0_label_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:62: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_label = torch.tensor(torch.load(class1_label_pth))
epoch[0] train_loss: 0.060109 	val_loss: 0.040587
epoch[1] train_loss: 0.052528 	val_loss: 0.036601
epoch[2] train_loss: 0.048206 	val_loss: 0.035522
epoch[3] train_loss: 0.046786 	val_loss: 0.037976
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
epoch[4] train_loss: 0.047185 	val_loss: 0.036482
epoch[5] train_loss: 0.046386 	val_loss: 0.035269
epoch[6] train_loss: 0.046218 	val_loss: 0.033761
epoch[7] train_loss: 0.041373 	val_loss: 0.029156
epoch[8] train_loss: 0.032045 	val_loss: 0.020534
epoch[9] train_loss: 0.022516 	val_loss: 0.018804
epoch[10] train_loss: 0.019558 	val_loss: 0.016649
epoch[11] train_loss: 0.017735 	val_loss: 0.015818
epoch[12] train_loss: 0.016829 	val_loss: 0.014770
epoch[13] train_loss: 0.015564 	val_loss: 0.013513
epoch[14] train_loss: 0.014374 	val_loss: 0.012147
epoch[15] train_loss: 0.013713 	val_loss: 0.012031
epoch[16] train_loss: 0.013467 	val_loss: 0.011926
epoch[17] train_loss: 0.013153 	val_loss: 0.011603
epoch[18] train_loss: 0.012880 	val_loss: 0.011635
epoch[19] train_loss: 0.012752 	val_loss: 0.011239
epoch[20] train_loss: 0.012434 	val_loss: 0.011071
epoch[21] train_loss: 0.012051 	val_loss: 0.010785
epoch[22] train_loss: 0.011416 	val_loss: 0.009762
epoch[23] train_loss: 0.010386 	val_loss: 0.008809
epoch[24] train_loss: 0.009278 	val_loss: 0.007672
epoch[25] train_loss: 0.008882 	val_loss: 0.007233
epoch[26] train_loss: 0.008560 	val_loss: 0.006919
epoch[27] train_loss: 0.008216 	val_loss: 0.006927
epoch[28] train_loss: 0.008068 	val_loss: 0.006816
epoch[29] train_loss: 0.007973 	val_loss: 0.006701
epoch[30] train_loss: 0.007838 	val_loss: 0.006703
epoch[31] train_loss: 0.007824 	val_loss: 0.006627
epoch[32] train_loss: 0.007893 	val_loss: 0.006554
epoch[33] train_loss: 0.007793 	val_loss: 0.006579
epoch[34] train_loss: 0.007653 	val_loss: 0.006450
epoch[35] train_loss: 0.007586 	val_loss: 0.006677
epoch[36] train_loss: 0.007674 	val_loss: 0.006624
epoch[37] train_loss: 0.007510 	val_loss: 0.006219
epoch[38] train_loss: 0.007238 	val_loss: 0.006105
epoch[39] train_loss: 0.007205 	val_loss: 0.006169
epoch[40] train_loss: 0.007091 	val_loss: 0.006216
epoch[41] train_loss: 0.007056 	val_loss: 0.005976
epoch[42] train_loss: 0.006945 	val_loss: 0.005824
epoch[43] train_loss: 0.006770 	val_loss: 0.005900
epoch[44] train_loss: 0.006735 	val_loss: 0.005937
epoch[45] train_loss: 0.006643 	val_loss: 0.006001
epoch[46] train_loss: 0.006730 	val_loss: 0.005844
epoch[47] train_loss: 0.006624 	val_loss: 0.005810
epoch[48] train_loss: 0.006601 	val_loss: 0.005845
epoch[49] train_loss: 0.006532 	val_loss: 0.005624
epoch[50] train_loss: 0.006466 	val_loss: 0.005673
epoch[51] train_loss: 0.006414 	val_loss: 0.005526
epoch[52] train_loss: 0.006391 	val_loss: 0.005533
epoch[53] train_loss: 0.006363 	val_loss: 0.005484
epoch[54] train_loss: 0.006292 	val_loss: 0.005449
epoch[55] train_loss: 0.006144 	val_loss: 0.005323
epoch[56] train_loss: 0.005965 	val_loss: 0.005183
epoch[57] train_loss: 0.005712 	val_loss: 0.005058
epoch[58] train_loss: 0.005461 	val_loss: 0.004902
epoch[59] train_loss: 0.005068 	val_loss: 0.004399
epoch[60] train_loss: 0.004713 	val_loss: 0.004127
epoch[61] train_loss: 0.004603 	val_loss: 0.004062
epoch[62] train_loss: 0.004806 	val_loss: 0.004272
epoch[63] train_loss: 0.004530 	val_loss: 0.003990
epoch[64] train_loss: 0.004240 	val_loss: 0.003759
epoch[65] train_loss: 0.004020 	val_loss: 0.003502
epoch[66] train_loss: 0.003847 	val_loss: 0.003356
epoch[67] train_loss: 0.003665 	val_loss: 0.003303
epoch[68] train_loss: 0.003578 	val_loss: 0.003575
epoch[69] train_loss: 0.003586 	val_loss: 0.003134
epoch[70] train_loss: 0.003518 	val_loss: 0.003319
epoch[71] train_loss: 0.003540 	val_loss: 0.003281
epoch[72] train_loss: 0.003429 	val_loss: 0.003204
epoch[73] train_loss: 0.003368 	val_loss: 0.003237
epoch[74] train_loss: 0.003448 	val_loss: 0.003255
epoch[75] train_loss: 0.003350 	val_loss: 0.003113
epoch[76] train_loss: 0.003311 	val_loss: 0.002995
epoch[77] train_loss: 0.003284 	val_loss: 0.002933
epoch[78] train_loss: 0.003189 	val_loss: 0.002812
epoch[79] train_loss: 0.003199 	val_loss: 0.002872
epoch[80] train_loss: 0.003200 	val_loss: 0.002961
epoch[81] train_loss: 0.003269 	val_loss: 0.003130
epoch[82] train_loss: 0.003286 	val_loss: 0.003121
epoch[83] train_loss: 0.003217 	val_loss: 0.002985
epoch[84] train_loss: 0.003187 	val_loss: 0.003076
epoch[85] train_loss: 0.003092 	val_loss: 0.002951
epoch[86] train_loss: 0.003063 	val_loss: 0.002992
epoch[87] train_loss: 0.003034 	val_loss: 0.003086
epoch[88] train_loss: 0.003064 	val_loss: 0.002997
epoch[89] train_loss: 0.003076 	val_loss: 0.003015
epoch[90] train_loss: 0.003001 	val_loss: 0.003032
epoch[91] train_loss: 0.002945 	val_loss: 0.002858
epoch[92] train_loss: 0.002886 	val_loss: 0.003069
epoch[93] train_loss: 0.002904 	val_loss: 0.003063
epoch[94] train_loss: 0.002869 	val_loss: 0.002912
epoch[95] train_loss: 0.002844 	val_loss: 0.003151
epoch[96] train_loss: 0.002915 	val_loss: 0.002887
epoch[97] train_loss: 0.002868 	val_loss: 0.003046
epoch[98] train_loss: 0.002874 	val_loss: 0.002972
epoch[99] train_loss: 0.002814 	val_loss: 0.003017
epoch[100] train_loss: 0.002858 	val_loss: 0.003077
epoch[101] train_loss: 0.002909 	val_loss: 0.002862
epoch[102] train_loss: 0.002877 	val_loss: 0.002900
epoch[103] train_loss: 0.002836 	val_loss: 0.002912
epoch[104] train_loss: 0.002763 	val_loss: 0.003057
epoch[105] train_loss: 0.002760 	val_loss: 0.002871
epoch[106] train_loss: 0.002725 	val_loss: 0.003005
epoch[107] train_loss: 0.002705 	val_loss: 0.002905
epoch[108] train_loss: 0.002665 	val_loss: 0.002927
epoch[109] train_loss: 0.002642 	val_loss: 0.002822
epoch[110] train_loss: 0.002639 	val_loss: 0.002799
epoch[111] train_loss: 0.002669 	val_loss: 0.002726
epoch[112] train_loss: 0.002748 	val_loss: 0.002888
epoch[113] train_loss: 0.002727 	val_loss: 0.002809
epoch[114] train_loss: 0.002741 	val_loss: 0.002786
epoch[115] train_loss: 0.002704 	val_loss: 0.002713
epoch[116] train_loss: 0.002677 	val_loss: 0.002736
epoch[117] train_loss: 0.002607 	val_loss: 0.002851
epoch[118] train_loss: 0.002544 	val_loss: 0.002723
epoch[119] train_loss: 0.002580 	val_loss: 0.002603
epoch[120] train_loss: 0.002595 	val_loss: 0.002494
epoch[121] train_loss: 0.002578 	val_loss: 0.002672
epoch[122] train_loss: 0.002693 	val_loss: 0.002809
epoch[123] train_loss: 0.002654 	val_loss: 0.002677
epoch[124] train_loss: 0.002622 	val_loss: 0.002887
epoch[125] train_loss: 0.002591 	val_loss: 0.002594
epoch[126] train_loss: 0.002598 	val_loss: 0.002644
epoch[127] train_loss: 0.002571 	val_loss: 0.002653
epoch[128] train_loss: 0.002552 	val_loss: 0.002546
epoch[129] train_loss: 0.002522 	val_loss: 0.002546
epoch[130] train_loss: 0.002461 	val_loss: 0.002526
epoch[131] train_loss: 0.002424 	val_loss: 0.002542
epoch[132] train_loss: 0.002422 	val_loss: 0.002518
epoch[133] train_loss: 0.002500 	val_loss: 0.002545
epoch[134] train_loss: 0.002480 	val_loss: 0.002622
epoch[135] train_loss: 0.002443 	val_loss: 0.002525
epoch[136] train_loss: 0.002401 	val_loss: 0.002644
epoch[137] train_loss: 0.002471 	val_loss: 0.002645
epoch[138] train_loss: 0.002421 	val_loss: 0.002521
epoch[139] train_loss: 0.002403 	val_loss: 0.002544
epoch[140] train_loss: 0.002449 	val_loss: 0.002579
epoch[141] train_loss: 0.002388 	val_loss: 0.002444
epoch[142] train_loss: 0.002462 	val_loss: 0.002447
epoch[143] train_loss: 0.002412 	val_loss: 0.002441
epoch[144] train_loss: 0.002356 	val_loss: 0.002386
epoch[145] train_loss: 0.002331 	val_loss: 0.002292
epoch[146] train_loss: 0.002283 	val_loss: 0.002341
epoch[147] train_loss: 0.002341 	val_loss: 0.002335
epoch[148] train_loss: 0.002322 	val_loss: 0.002519
epoch[149] train_loss: 0.002325 	val_loss: 0.002381
epoch[150] train_loss: 0.002396 	val_loss: 0.002424
epoch[151] train_loss: 0.002432 	val_loss: 0.002435
epoch[152] train_loss: 0.002308 	val_loss: 0.002302
epoch[153] train_loss: 0.002262 	val_loss: 0.002302
epoch[154] train_loss: 0.002218 	val_loss: 0.002167
epoch[155] train_loss: 0.002179 	val_loss: 0.002201
epoch[156] train_loss: 0.002108 	val_loss: 0.002201
epoch[157] train_loss: 0.002132 	val_loss: 0.002068
epoch[158] train_loss: 0.002098 	val_loss: 0.001997
epoch[159] train_loss: 0.002053 	val_loss: 0.002044
epoch[160] train_loss: 0.002052 	val_loss: 0.001935
epoch[161] train_loss: 0.002024 	val_loss: 0.001966
epoch[162] train_loss: 0.002006 	val_loss: 0.001984
epoch[163] train_loss: 0.002050 	val_loss: 0.002114
epoch[164] train_loss: 0.002070 	val_loss: 0.002190
epoch[165] train_loss: 0.002036 	val_loss: 0.002003
epoch[166] train_loss: 0.002015 	val_loss: 0.001967
epoch[167] train_loss: 0.001998 	val_loss: 0.002069
epoch[168] train_loss: 0.002051 	val_loss: 0.002017
epoch[169] train_loss: 0.002036 	val_loss: 0.002129
epoch[170] train_loss: 0.001975 	val_loss: 0.001993
epoch[171] train_loss: 0.001939 	val_loss: 0.002019
epoch[172] train_loss: 0.001999 	val_loss: 0.002017
epoch[173] train_loss: 0.001959 	val_loss: 0.001979
epoch[174] train_loss: 0.001920 	val_loss: 0.002017
epoch[175] train_loss: 0.001912 	val_loss: 0.001898
epoch[176] train_loss: 0.001916 	val_loss: 0.002048
epoch[177] train_loss: 0.001948 	val_loss: 0.001937
epoch[178] train_loss: 0.001880 	val_loss: 0.001924
epoch[179] train_loss: 0.001897 	val_loss: 0.002052
epoch[180] train_loss: 0.001910 	val_loss: 0.001777
epoch[181] train_loss: 0.001884 	val_loss: 0.002016
epoch[182] train_loss: 0.001911 	val_loss: 0.002039
epoch[183] train_loss: 0.001892 	val_loss: 0.001978
epoch[184] train_loss: 0.001862 	val_loss: 0.002025
epoch[185] train_loss: 0.001833 	val_loss: 0.001862
epoch[186] train_loss: 0.001790 	val_loss: 0.001733
epoch[187] train_loss: 0.001752 	val_loss: 0.001764
epoch[188] train_loss: 0.001686 	val_loss: 0.001683
epoch[189] train_loss: 0.001665 	val_loss: 0.001689
epoch[190] train_loss: 0.001634 	val_loss: 0.001671
epoch[191] train_loss: 0.001657 	val_loss: 0.001763
epoch[192] train_loss: 0.001627 	val_loss: 0.001735
epoch[193] train_loss: 0.001634 	val_loss: 0.001698
epoch[194] train_loss: 0.001658 	val_loss: 0.001868
epoch[195] train_loss: 0.001733 	val_loss: 0.001727
epoch[196] train_loss: 0.001645 	val_loss: 0.001804
epoch[197] train_loss: 0.001685 	val_loss: 0.001717
epoch[198] train_loss: 0.001699 	val_loss: 0.001789
epoch[199] train_loss: 0.001665 	val_loss: 0.001813
epoch[200] train_loss: 0.001686 	val_loss: 0.001758
epoch[201] train_loss: 0.001645 	val_loss: 0.001706
epoch[202] train_loss: 0.001594 	val_loss: 0.001727
epoch[203] train_loss: 0.001603 	val_loss: 0.001816
epoch[204] train_loss: 0.001597 	val_loss: 0.001792
epoch[205] train_loss: 0.001591 	val_loss: 0.001713
epoch[206] train_loss: 0.001590 	val_loss: 0.001682
epoch[207] train_loss: 0.001621 	val_loss: 0.001801
epoch[208] train_loss: 0.001608 	val_loss: 0.001777
epoch[209] train_loss: 0.001615 	val_loss: 0.001749
epoch[210] train_loss: 0.001621 	val_loss: 0.001782
epoch[211] train_loss: 0.001566 	val_loss: 0.001747
epoch[212] train_loss: 0.001536 	val_loss: 0.001799
epoch[213] train_loss: 0.001526 	val_loss: 0.001764
epoch[214] train_loss: 0.001540 	val_loss: 0.001750
epoch[215] train_loss: 0.001540 	val_loss: 0.001758
epoch[216] train_loss: 0.001573 	val_loss: 0.001759
epoch[217] train_loss: 0.001519 	val_loss: 0.001732
epoch[218] train_loss: 0.001508 	val_loss: 0.001707
epoch[219] train_loss: 0.001495 	val_loss: 0.001728
epoch[220] train_loss: 0.001522 	val_loss: 0.001740
epoch[221] train_loss: 0.001572 	val_loss: 0.001823
epoch[222] train_loss: 0.001619 	val_loss: 0.001771
epoch[223] train_loss: 0.001638 	val_loss: 0.001829
epoch[224] train_loss: 0.001593 	val_loss: 0.001826
epoch[225] train_loss: 0.001593 	val_loss: 0.001907
epoch[226] train_loss: 0.001645 	val_loss: 0.002005
epoch[227] train_loss: 0.001631 	val_loss: 0.001806
epoch[228] train_loss: 0.001635 	val_loss: 0.001790
epoch[229] train_loss: 0.001646 	val_loss: 0.001907
epoch[230] train_loss: 0.001633 	val_loss: 0.001814
epoch[231] train_loss: 0.001538 	val_loss: 0.001961
epoch[232] train_loss: 0.001541 	val_loss: 0.001810
epoch[233] train_loss: 0.001598 	val_loss: 0.001938
epoch[234] train_loss: 0.001569 	val_loss: 0.001791
epoch[235] train_loss: 0.001562 	val_loss: 0.001829
epoch[236] train_loss: 0.001535 	val_loss: 0.001829
epoch[237] train_loss: 0.001490 	val_loss: 0.001950
epoch[238] train_loss: 0.001570 	val_loss: 0.002077
epoch[239] train_loss: 0.001593 	val_loss: 0.001922
epoch[240] train_loss: 0.001654 	val_loss: 0.001937
epoch[241] train_loss: 0.001611 	val_loss: 0.001938
epoch[242] train_loss: 0.001666 	val_loss: 0.001931
epoch[243] train_loss: 0.001674 	val_loss: 0.002013
epoch[244] train_loss: 0.001702 	val_loss: 0.001985
epoch[245] train_loss: 0.001621 	val_loss: 0.001820
epoch[246] train_loss: 0.001618 	val_loss: 0.001732
epoch[247] train_loss: 0.001564 	val_loss: 0.001717
epoch[248] train_loss: 0.001577 	val_loss: 0.001733
epoch[249] train_loss: 0.001565 	val_loss: 0.001631
epoch[250] train_loss: 0.001547 	val_loss: 0.001592
epoch[251] train_loss: 0.001487 	val_loss: 0.001547
epoch[252] train_loss: 0.001449 	val_loss: 0.001552
epoch[253] train_loss: 0.001468 	val_loss: 0.001596
epoch[254] train_loss: 0.001453 	val_loss: 0.001644
epoch[255] train_loss: 0.001478 	val_loss: 0.001650
epoch[256] train_loss: 0.001506 	val_loss: 0.001562
epoch[257] train_loss: 0.001516 	val_loss: 0.001761
epoch[258] train_loss: 0.001554 	val_loss: 0.001689
epoch[259] train_loss: 0.001476 	val_loss: 0.001752
epoch[260] train_loss: 0.001511 	val_loss: 0.001619
epoch[261] train_loss: 0.001565 	val_loss: 0.001708
epoch[262] train_loss: 0.001542 	val_loss: 0.001586
epoch[263] train_loss: 0.001492 	val_loss: 0.001598
epoch[264] train_loss: 0.001443 	val_loss: 0.001721
epoch[265] train_loss: 0.001468 	val_loss: 0.001703
epoch[266] train_loss: 0.001437 	val_loss: 0.001791
epoch[267] train_loss: 0.001456 	val_loss: 0.001646
epoch[268] train_loss: 0.001457 	val_loss: 0.001631
epoch[269] train_loss: 0.001423 	val_loss: 0.001718
epoch[270] train_loss: 0.001413 	val_loss: 0.001643
epoch[271] train_loss: 0.001419 	val_loss: 0.001649
epoch[272] train_loss: 0.001411 	val_loss: 0.001678
epoch[273] train_loss: 0.001463 	val_loss: 0.001689
epoch[274] train_loss: 0.001443 	val_loss: 0.001667
epoch[275] train_loss: 0.001394 	val_loss: 0.001677
epoch[276] train_loss: 0.001385 	val_loss: 0.001587
epoch[277] train_loss: 0.001333 	val_loss: 0.001567
epoch[278] train_loss: 0.001324 	val_loss: 0.001564
epoch[279] train_loss: 0.001325 	val_loss: 0.001639
epoch[280] train_loss: 0.001295 	val_loss: 0.001592
epoch[281] train_loss: 0.001339 	val_loss: 0.001644
epoch[282] train_loss: 0.001474 	val_loss: 0.001692
epoch[283] train_loss: 0.001536 	val_loss: 0.001566
epoch[284] train_loss: 0.001395 	val_loss: 0.001665
epoch[285] train_loss: 0.001438 	val_loss: 0.001678
epoch[286] train_loss: 0.001420 	val_loss: 0.001869
epoch[287] train_loss: 0.001560 	val_loss: 0.001799
epoch[288] train_loss: 0.001546 	val_loss: 0.001782
epoch[289] train_loss: 0.001450 	val_loss: 0.001578
epoch[290] train_loss: 0.001355 	val_loss: 0.001484
epoch[291] train_loss: 0.001313 	val_loss: 0.001557
epoch[292] train_loss: 0.001302 	val_loss: 0.001466
epoch[293] train_loss: 0.001281 	val_loss: 0.001442
epoch[294] train_loss: 0.001289 	val_loss: 0.001502
epoch[295] train_loss: 0.001293 	val_loss: 0.001529
epoch[296] train_loss: 0.001372 	val_loss: 0.001566
epoch[297] train_loss: 0.001335 	val_loss: 0.001534
epoch[298] train_loss: 0.001317 	val_loss: 0.001607
epoch[299] train_loss: 0.001355 	val_loss: 0.001517
epoch[300] train_loss: 0.001307 	val_loss: 0.001518
try to save in testdir
293 save ... ./saved_models/hard_mitbih/2/
train: 0.0013	
val: 0.0014	
save done!