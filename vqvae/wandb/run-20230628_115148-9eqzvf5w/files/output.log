dataset is hard_mitbih
X shape:torch.Size([400, 208]), y shape:torch.Size([400])
/home/smjo/xai_timeseries/vqvae/dataload.py:59: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:60: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_data = torch.tensor(torch.load(class0_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class0_label = torch.tensor(torch.load(class0_label_pth))
/home/smjo/xai_timeseries/vqvae/dataload.py:62: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class1_label = torch.tensor(torch.load(class1_label_pth))
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.
epoch[0] train_loss: 0.085052 	val_loss: 0.057124
epoch[1] train_loss: 0.068119 	val_loss: 0.043324
epoch[2] train_loss: 0.053008 	val_loss: 0.036764
epoch[3] train_loss: 0.049692 	val_loss: 0.039915
epoch[4] train_loss: 0.045808 	val_loss: 0.033941
epoch[5] train_loss: 0.044932 	val_loss: 0.033426
epoch[6] train_loss: 0.043739 	val_loss: 0.034905
epoch[7] train_loss: 0.040245 	val_loss: 0.026752
epoch[8] train_loss: 0.030336 	val_loss: 0.021830
epoch[9] train_loss: 0.020901 	val_loss: 0.013424
epoch[10] train_loss: 0.014366 	val_loss: 0.012393
epoch[11] train_loss: 0.013849 	val_loss: 0.012981
epoch[12] train_loss: 0.013846 	val_loss: 0.012266
epoch[13] train_loss: 0.012738 	val_loss: 0.010938
epoch[14] train_loss: 0.011589 	val_loss: 0.010051
epoch[15] train_loss: 0.010612 	val_loss: 0.009076
epoch[16] train_loss: 0.009292 	val_loss: 0.007747
epoch[17] train_loss: 0.008167 	val_loss: 0.007331
epoch[18] train_loss: 0.007915 	val_loss: 0.006899
epoch[19] train_loss: 0.007471 	val_loss: 0.006473
epoch[20] train_loss: 0.007231 	val_loss: 0.006304
epoch[21] train_loss: 0.007038 	val_loss: 0.006160
epoch[22] train_loss: 0.006870 	val_loss: 0.005928
epoch[23] train_loss: 0.006657 	val_loss: 0.005786
epoch[24] train_loss: 0.006498 	val_loss: 0.005607
epoch[25] train_loss: 0.006312 	val_loss: 0.005388
epoch[26] train_loss: 0.006080 	val_loss: 0.005150
epoch[27] train_loss: 0.005835 	val_loss: 0.004961
epoch[28] train_loss: 0.005510 	val_loss: 0.004651
epoch[29] train_loss: 0.005022 	val_loss: 0.004173
epoch[30] train_loss: 0.004435 	val_loss: 0.003702
epoch[31] train_loss: 0.003979 	val_loss: 0.003487
epoch[32] train_loss: 0.003749 	val_loss: 0.003278
epoch[33] train_loss: 0.003538 	val_loss: 0.003033
epoch[34] train_loss: 0.003305 	val_loss: 0.002796
epoch[35] train_loss: 0.003078 	val_loss: 0.002661
epoch[36] train_loss: 0.002890 	val_loss: 0.002500
epoch[37] train_loss: 0.002730 	val_loss: 0.002344
epoch[38] train_loss: 0.002593 	val_loss: 0.002270
epoch[39] train_loss: 0.002518 	val_loss: 0.002234
epoch[40] train_loss: 0.002444 	val_loss: 0.002098
epoch[41] train_loss: 0.002366 	val_loss: 0.001982
epoch[42] train_loss: 0.002265 	val_loss: 0.001945
epoch[43] train_loss: 0.002201 	val_loss: 0.001946
epoch[44] train_loss: 0.002137 	val_loss: 0.001916
epoch[45] train_loss: 0.002126 	val_loss: 0.001842
epoch[46] train_loss: 0.002060 	val_loss: 0.001756
epoch[47] train_loss: 0.002020 	val_loss: 0.001746
epoch[48] train_loss: 0.001957 	val_loss: 0.001677
epoch[49] train_loss: 0.001911 	val_loss: 0.001711
epoch[50] train_loss: 0.001918 	val_loss: 0.001607
epoch[51] train_loss: 0.001880 	val_loss: 0.001662
epoch[52] train_loss: 0.001934 	val_loss: 0.001588
epoch[53] train_loss: 0.001847 	val_loss: 0.001657
epoch[54] train_loss: 0.001850 	val_loss: 0.001628
epoch[55] train_loss: 0.001781 	val_loss: 0.001547
epoch[56] train_loss: 0.001739 	val_loss: 0.001482
epoch[57] train_loss: 0.001682 	val_loss: 0.001473
epoch[58] train_loss: 0.001636 	val_loss: 0.001374
epoch[59] train_loss: 0.001600 	val_loss: 0.001353
epoch[60] train_loss: 0.001568 	val_loss: 0.001335
epoch[61] train_loss: 0.001527 	val_loss: 0.001360
epoch[62] train_loss: 0.001528 	val_loss: 0.001336
epoch[63] train_loss: 0.001510 	val_loss: 0.001285
epoch[64] train_loss: 0.001482 	val_loss: 0.001281
epoch[65] train_loss: 0.001457 	val_loss: 0.001249
epoch[66] train_loss: 0.001465 	val_loss: 0.001259
epoch[67] train_loss: 0.001449 	val_loss: 0.001204
epoch[68] train_loss: 0.001409 	val_loss: 0.001194
epoch[69] train_loss: 0.001387 	val_loss: 0.001280
epoch[70] train_loss: 0.001386 	val_loss: 0.001158
epoch[71] train_loss: 0.001381 	val_loss: 0.001221
epoch[72] train_loss: 0.001383 	val_loss: 0.001169
epoch[73] train_loss: 0.001343 	val_loss: 0.001199
epoch[74] train_loss: 0.001334 	val_loss: 0.001176
epoch[75] train_loss: 0.001300 	val_loss: 0.001132
epoch[76] train_loss: 0.001271 	val_loss: 0.001136
epoch[77] train_loss: 0.001274 	val_loss: 0.001182
epoch[78] train_loss: 0.001270 	val_loss: 0.001159
epoch[79] train_loss: 0.001269 	val_loss: 0.001126
epoch[80] train_loss: 0.001283 	val_loss: 0.001111
epoch[81] train_loss: 0.001257 	val_loss: 0.001097
epoch[82] train_loss: 0.001237 	val_loss: 0.001111
epoch[83] train_loss: 0.001224 	val_loss: 0.001092
epoch[84] train_loss: 0.001213 	val_loss: 0.001071
epoch[85] train_loss: 0.001221 	val_loss: 0.001073
epoch[86] train_loss: 0.001215 	val_loss: 0.001089
epoch[87] train_loss: 0.001200 	val_loss: 0.001074
epoch[88] train_loss: 0.001174 	val_loss: 0.001123
epoch[89] train_loss: 0.001205 	val_loss: 0.001096
epoch[90] train_loss: 0.001184 	val_loss: 0.001107
epoch[91] train_loss: 0.001194 	val_loss: 0.001075
epoch[92] train_loss: 0.001189 	val_loss: 0.001135
epoch[93] train_loss: 0.001186 	val_loss: 0.001140
epoch[94] train_loss: 0.001196 	val_loss: 0.001060
epoch[95] train_loss: 0.001159 	val_loss: 0.001087
epoch[96] train_loss: 0.001121 	val_loss: 0.001088
epoch[97] train_loss: 0.001128 	val_loss: 0.001057
epoch[98] train_loss: 0.001102 	val_loss: 0.001075
epoch[99] train_loss: 0.001108 	val_loss: 0.001076
epoch[100] train_loss: 0.001104 	val_loss: 0.001056
epoch[101] train_loss: 0.001085 	val_loss: 0.001021
epoch[102] train_loss: 0.001070 	val_loss: 0.001047
epoch[103] train_loss: 0.001068 	val_loss: 0.001064
epoch[104] train_loss: 0.001060 	val_loss: 0.001022
epoch[105] train_loss: 0.001055 	val_loss: 0.001020
epoch[106] train_loss: 0.001040 	val_loss: 0.000977
epoch[107] train_loss: 0.001022 	val_loss: 0.001002
epoch[108] train_loss: 0.001035 	val_loss: 0.001035
epoch[109] train_loss: 0.001017 	val_loss: 0.001049
epoch[110] train_loss: 0.001020 	val_loss: 0.000994
epoch[111] train_loss: 0.000996 	val_loss: 0.000986
epoch[112] train_loss: 0.000991 	val_loss: 0.000981
epoch[113] train_loss: 0.000994 	val_loss: 0.000948
epoch[114] train_loss: 0.000985 	val_loss: 0.000984
epoch[115] train_loss: 0.000984 	val_loss: 0.000990
epoch[116] train_loss: 0.000973 	val_loss: 0.000963
epoch[117] train_loss: 0.000966 	val_loss: 0.000938
epoch[118] train_loss: 0.000961 	val_loss: 0.000922
epoch[119] train_loss: 0.000953 	val_loss: 0.000971
epoch[120] train_loss: 0.000941 	val_loss: 0.000943
epoch[121] train_loss: 0.000951 	val_loss: 0.000966
epoch[122] train_loss: 0.000934 	val_loss: 0.000972
epoch[123] train_loss: 0.000937 	val_loss: 0.000951
epoch[124] train_loss: 0.000942 	val_loss: 0.000923
epoch[125] train_loss: 0.000911 	val_loss: 0.000946
epoch[126] train_loss: 0.000901 	val_loss: 0.000921
epoch[127] train_loss: 0.000906 	val_loss: 0.000924
epoch[128] train_loss: 0.000911 	val_loss: 0.000909
epoch[129] train_loss: 0.000910 	val_loss: 0.000931
epoch[130] train_loss: 0.000927 	val_loss: 0.000922
epoch[131] train_loss: 0.000912 	val_loss: 0.000950
epoch[132] train_loss: 0.000915 	val_loss: 0.000916
epoch[133] train_loss: 0.000949 	val_loss: 0.000958
epoch[134] train_loss: 0.000951 	val_loss: 0.000908
epoch[135] train_loss: 0.000912 	val_loss: 0.000903
epoch[136] train_loss: 0.000909 	val_loss: 0.000929
epoch[137] train_loss: 0.000888 	val_loss: 0.000915
epoch[138] train_loss: 0.000876 	val_loss: 0.000893
epoch[139] train_loss: 0.000866 	val_loss: 0.000950
epoch[140] train_loss: 0.000869 	val_loss: 0.000894
epoch[141] train_loss: 0.000857 	val_loss: 0.000873
epoch[142] train_loss: 0.000849 	val_loss: 0.000886
epoch[143] train_loss: 0.000862 	val_loss: 0.000840
epoch[144] train_loss: 0.000855 	val_loss: 0.000887
epoch[145] train_loss: 0.000858 	val_loss: 0.000933
epoch[146] train_loss: 0.000869 	val_loss: 0.000933
epoch[147] train_loss: 0.000869 	val_loss: 0.000968
epoch[148] train_loss: 0.000858 	val_loss: 0.000925
epoch[149] train_loss: 0.000826 	val_loss: 0.000881
epoch[150] train_loss: 0.000818 	val_loss: 0.000837
epoch[151] train_loss: 0.000811 	val_loss: 0.000867
epoch[152] train_loss: 0.000808 	val_loss: 0.000838
epoch[153] train_loss: 0.000809 	val_loss: 0.000836
epoch[154] train_loss: 0.000798 	val_loss: 0.000885
epoch[155] train_loss: 0.000796 	val_loss: 0.000863
epoch[156] train_loss: 0.000782 	val_loss: 0.000872
epoch[157] train_loss: 0.000783 	val_loss: 0.000844
epoch[158] train_loss: 0.000786 	val_loss: 0.000861
epoch[159] train_loss: 0.000784 	val_loss: 0.000829
epoch[160] train_loss: 0.000773 	val_loss: 0.000842
epoch[161] train_loss: 0.000774 	val_loss: 0.000898
epoch[162] train_loss: 0.000801 	val_loss: 0.000900
epoch[163] train_loss: 0.000797 	val_loss: 0.000857
epoch[164] train_loss: 0.000787 	val_loss: 0.000877
epoch[165] train_loss: 0.000782 	val_loss: 0.000841
epoch[166] train_loss: 0.000753 	val_loss: 0.000891
epoch[167] train_loss: 0.000776 	val_loss: 0.000864
epoch[168] train_loss: 0.000756 	val_loss: 0.000843
epoch[169] train_loss: 0.000756 	val_loss: 0.000862
epoch[170] train_loss: 0.000744 	val_loss: 0.000834
epoch[171] train_loss: 0.000741 	val_loss: 0.000840
epoch[172] train_loss: 0.000732 	val_loss: 0.000822
epoch[173] train_loss: 0.000725 	val_loss: 0.000828
epoch[174] train_loss: 0.000721 	val_loss: 0.000792
epoch[175] train_loss: 0.000764 	val_loss: 0.000836
epoch[176] train_loss: 0.000727 	val_loss: 0.000841
epoch[177] train_loss: 0.000748 	val_loss: 0.000804
epoch[178] train_loss: 0.000746 	val_loss: 0.000808
epoch[179] train_loss: 0.000744 	val_loss: 0.000794
epoch[180] train_loss: 0.000719 	val_loss: 0.000807
epoch[181] train_loss: 0.000723 	val_loss: 0.000790
epoch[182] train_loss: 0.000710 	val_loss: 0.000777
epoch[183] train_loss: 0.000692 	val_loss: 0.000765
epoch[184] train_loss: 0.000694 	val_loss: 0.000760
epoch[185] train_loss: 0.000683 	val_loss: 0.000740
epoch[186] train_loss: 0.000680 	val_loss: 0.000795
epoch[187] train_loss: 0.000666 	val_loss: 0.000763
epoch[188] train_loss: 0.000659 	val_loss: 0.000801
epoch[189] train_loss: 0.000690 	val_loss: 0.000788
epoch[190] train_loss: 0.000687 	val_loss: 0.000781
epoch[191] train_loss: 0.000677 	val_loss: 0.000806
epoch[192] train_loss: 0.000682 	val_loss: 0.000782
epoch[193] train_loss: 0.000676 	val_loss: 0.000761
epoch[194] train_loss: 0.000657 	val_loss: 0.000792
epoch[195] train_loss: 0.000667 	val_loss: 0.000783
epoch[196] train_loss: 0.000669 	val_loss: 0.000750
epoch[197] train_loss: 0.000654 	val_loss: 0.000780
epoch[198] train_loss: 0.000644 	val_loss: 0.000788
epoch[199] train_loss: 0.000639 	val_loss: 0.000779
epoch[200] train_loss: 0.000631 	val_loss: 0.000724
epoch[201] train_loss: 0.000646 	val_loss: 0.000761
epoch[202] train_loss: 0.000633 	val_loss: 0.000758
epoch[203] train_loss: 0.000638 	val_loss: 0.000682
epoch[204] train_loss: 0.000622 	val_loss: 0.000718
epoch[205] train_loss: 0.000640 	val_loss: 0.000759
epoch[206] train_loss: 0.000638 	val_loss: 0.000712
epoch[207] train_loss: 0.000635 	val_loss: 0.000706
epoch[208] train_loss: 0.000611 	val_loss: 0.000686
epoch[209] train_loss: 0.000605 	val_loss: 0.000703
epoch[210] train_loss: 0.000597 	val_loss: 0.000700
epoch[211] train_loss: 0.000595 	val_loss: 0.000714
epoch[212] train_loss: 0.000581 	val_loss: 0.000722
epoch[213] train_loss: 0.000594 	val_loss: 0.000746
epoch[214] train_loss: 0.000609 	val_loss: 0.000706
epoch[215] train_loss: 0.000599 	val_loss: 0.000758
epoch[216] train_loss: 0.000626 	val_loss: 0.000792
epoch[217] train_loss: 0.000621 	val_loss: 0.000697
epoch[218] train_loss: 0.000561 	val_loss: 0.000674
epoch[219] train_loss: 0.000558 	val_loss: 0.000676
epoch[220] train_loss: 0.000565 	val_loss: 0.000709
epoch[221] train_loss: 0.000552 	val_loss: 0.000667
epoch[222] train_loss: 0.000559 	val_loss: 0.000616
epoch[223] train_loss: 0.000559 	val_loss: 0.000663
epoch[224] train_loss: 0.000545 	val_loss: 0.000678
epoch[225] train_loss: 0.000528 	val_loss: 0.000637
epoch[226] train_loss: 0.000537 	val_loss: 0.000649
epoch[227] train_loss: 0.000526 	val_loss: 0.000688
epoch[228] train_loss: 0.000548 	val_loss: 0.000654
epoch[229] train_loss: 0.000554 	val_loss: 0.000639
epoch[230] train_loss: 0.000561 	val_loss: 0.000629
epoch[231] train_loss: 0.000541 	val_loss: 0.000668
epoch[232] train_loss: 0.000534 	val_loss: 0.000683
epoch[233] train_loss: 0.000562 	val_loss: 0.000642
epoch[234] train_loss: 0.000529 	val_loss: 0.000648
epoch[235] train_loss: 0.000522 	val_loss: 0.000633
epoch[236] train_loss: 0.000513 	val_loss: 0.000615
epoch[237] train_loss: 0.000510 	val_loss: 0.000680
epoch[238] train_loss: 0.000512 	val_loss: 0.000654
epoch[239] train_loss: 0.000535 	val_loss: 0.000703
epoch[240] train_loss: 0.000577 	val_loss: 0.000698
epoch[241] train_loss: 0.000546 	val_loss: 0.000663
epoch[242] train_loss: 0.000569 	val_loss: 0.000625
epoch[243] train_loss: 0.000549 	val_loss: 0.000668
epoch[244] train_loss: 0.000535 	val_loss: 0.000698
epoch[245] train_loss: 0.000537 	val_loss: 0.000709
epoch[246] train_loss: 0.000548 	val_loss: 0.000671
epoch[247] train_loss: 0.000554 	val_loss: 0.000685
epoch[248] train_loss: 0.000550 	val_loss: 0.000762
epoch[249] train_loss: 0.000544 	val_loss: 0.000698
epoch[250] train_loss: 0.000542 	val_loss: 0.000606
epoch[251] train_loss: 0.000515 	val_loss: 0.000716
epoch[252] train_loss: 0.000513 	val_loss: 0.000605
epoch[253] train_loss: 0.000521 	val_loss: 0.000715
epoch[254] train_loss: 0.000519 	val_loss: 0.000649
epoch[255] train_loss: 0.000507 	val_loss: 0.000637
epoch[256] train_loss: 0.000512 	val_loss: 0.000609
epoch[257] train_loss: 0.000490 	val_loss: 0.000610
epoch[258] train_loss: 0.000492 	val_loss: 0.000653
epoch[259] train_loss: 0.000478 	val_loss: 0.000672
epoch[260] train_loss: 0.000473 	val_loss: 0.000694
epoch[261] train_loss: 0.000476 	val_loss: 0.000608
epoch[262] train_loss: 0.000475 	val_loss: 0.000613
epoch[263] train_loss: 0.000478 	val_loss: 0.000588
epoch[264] train_loss: 0.000464 	val_loss: 0.000578
epoch[265] train_loss: 0.000469 	val_loss: 0.000574
epoch[266] train_loss: 0.000463 	val_loss: 0.000562
epoch[267] train_loss: 0.000444 	val_loss: 0.000574
epoch[268] train_loss: 0.000447 	val_loss: 0.000548
epoch[269] train_loss: 0.000428 	val_loss: 0.000589
epoch[270] train_loss: 0.000429 	val_loss: 0.000524
epoch[271] train_loss: 0.000431 	val_loss: 0.000558
epoch[272] train_loss: 0.000425 	val_loss: 0.000554
epoch[273] train_loss: 0.000422 	val_loss: 0.000566
epoch[274] train_loss: 0.000444 	val_loss: 0.000555
epoch[275] train_loss: 0.000426 	val_loss: 0.000571
epoch[276] train_loss: 0.000415 	val_loss: 0.000626
epoch[277] train_loss: 0.000428 	val_loss: 0.000546
epoch[278] train_loss: 0.000425 	val_loss: 0.000560
epoch[279] train_loss: 0.000412 	val_loss: 0.000546
epoch[280] train_loss: 0.000416 	val_loss: 0.000589
epoch[281] train_loss: 0.000420 	val_loss: 0.000577
epoch[282] train_loss: 0.000421 	val_loss: 0.000622
epoch[283] train_loss: 0.000439 	val_loss: 0.000565
epoch[284] train_loss: 0.000432 	val_loss: 0.000558
epoch[285] train_loss: 0.000435 	val_loss: 0.000563
epoch[286] train_loss: 0.000423 	val_loss: 0.000533
epoch[287] train_loss: 0.000433 	val_loss: 0.000548
epoch[288] train_loss: 0.000421 	val_loss: 0.000562
epoch[289] train_loss: 0.000425 	val_loss: 0.000572
epoch[290] train_loss: 0.000433 	val_loss: 0.000547
epoch[291] train_loss: 0.000423 	val_loss: 0.000555
epoch[292] train_loss: 0.000424 	val_loss: 0.000577
epoch[293] train_loss: 0.000408 	val_loss: 0.000577
epoch[294] train_loss: 0.000405 	val_loss: 0.000598
epoch[295] train_loss: 0.000409 	val_loss: 0.000572
epoch[296] train_loss: 0.000389 	val_loss: 0.000511
epoch[297] train_loss: 0.000396 	val_loss: 0.000521
epoch[298] train_loss: 0.000390 	val_loss: 0.000556
epoch[299] train_loss: 0.000408 	val_loss: 0.000552
epoch[300] train_loss: 0.000406 	val_loss: 0.000610
try to save in testdir
296 save ... ./saved_models/hard_mitbih/4/
train: 0.0004	
val: 0.0005	
save done!